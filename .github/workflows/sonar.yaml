name: sonarqube-check
env: 
  GITHUB_REPOSITORY      : ${{ github.event.repository.name }}
  BACKUP_DIR             : 'backups'

  # Parameters for SonarQube:
  SONAR_TOKEN            : ${{ secrets.SONAR_TOKEN }}
  #SONAR_HOST_URL         : ${{ secrets.SONAR_HOST_URL }}
  SONAR_HOST_URL         : 'https://sq.peer.inc/'
  FETCH_DEPT             : '0'
on:
  push:
    branches:
      - master
jobs:
  sonarqube-check:
    name: sonarqube-check
    runs-on: ubuntu-latest
    steps:
      - name: set SonarQube project
        run: echo "sonar.projectKey=${{ env.GITHUB_REPOSITORY}}" > sonar-project.properties
      - run: sleep 20 
      
      - uses: actions/checkout@v2
        with:
          fetch-depth: 0
      - uses: sonarsource/sonarqube-scan-action@master
        env:
          SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
          SONAR_HOST_URL: ${{ secrets.SONAR_HOST_URL }}
